Index: log.c
===================================================================
--- log.c	(revision 191)
+++ log.c	(working copy)
@@ -49,6 +49,15 @@
 {
 	char str[MAX_PRINT_LEN]="";
 
+#ifdef _DEBUG
+    if (!fmsg) {
+      fmsg = fopen("C:\\Temp\\RTMP.log", "w");
+      RTMP_debuglevel = RTMP_LOGDEBUG2;
+    }
+#else
+    return;
+#endif	
+	
 	vsnprintf(str, MAX_PRINT_LEN-1, format, vl);
 
 	/* Filter out 'no-name' */
Index: rtmp.c
===================================================================
--- rtmp.c	(revision 191)
+++ rtmp.c	(working copy)
@@ -1244,11 +1244,6 @@
   return bHasMediaPacket;
 }
 
-#ifdef _DEBUG
-extern FILE *netstackdump;
-extern FILE *netstackdump_read;
-#endif
-
 static int
 ReadN(RTMP *r, char *buffer, int n)
 {
@@ -1311,9 +1316,6 @@
 	    SendBytesReceived(r);
 	}
       /*RTMP_Log(RTMP_LOGDEBUG, "%s: %d bytes\n", __FUNCTION__, nBytes); */
-#ifdef _DEBUG
-      fwrite(ptr, 1, nBytes, netstackdump_read);
-#endif
 
       if (nBytes == 0)
 	{
@@ -3519,10 +3527,6 @@
 {
   int rc;
 
-#ifdef _DEBUG
-  fwrite(buf, 1, len, netstackdump);
-#endif
-
 #if defined(CRYPTO) && !defined(NO_SSL)
   if (sb->sb_ssl)
     {
Index: rtmp_sys.h
===================================================================
--- rtmp_sys.h	(revision 191)
+++ rtmp_sys.h	(working copy)
@@ -35,6 +35,10 @@
 #else /* !_XBOX */
 #include <winsock2.h>
 #include <ws2tcpip.h>
+#define snprintf _snprintf
+#define strcasecmp stricmp
+#define strncasecmp strnicmp
+#define vsnprintf _vsnprintf
 #endif
 
 #define GetSockError()	WSAGetLastError()
